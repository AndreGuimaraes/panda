Panda on EC2
============

Launch the AMI
--------------
ec2-run-instances ami-5538dd3c -k pv-keypair

DO THIS: Install stuff which will be in the next AMI
-------------------------------------------

See README

Grab Panda
----------

cd /usr/local/panda
git clone git@github.com:newbamboo/panda.git
mkdir /usr/local/panda/videos # Place for temp videos

Create buckets, domains and queues
----------------------------------

* S3 bucket for video files (tip: name this a domain such videos.pandastream.com and you can setup a CNAME to S3)
* SQS queue for the encoding queue
* SimpleDB domains for videos, profiles and admin users

Login to the console with `merb -i` and run the following, probably replacing names with your own:

    Panda::Setup.create_s3_bucket('videos.pandastream.com')
    Panda::Setup.create_sqs_queue('panda_encoding')
    Panda::Setup.create_sdb_domain('panda_videos')
    Panda::Setup.create_sdb_domain('panda_profiles')
    Panda::Setup.create_sdb_domain('panda_users')

Configure Panda
---------------

Copy the `aws.rb.example` file in the config directory to `aws.rb` and change the names of the S3 bucket and SQS queue to the ones used in the previous step.

If you used different names for the SimpleDB domains you'll need to edit the second line of the files in the app/models directory.

Next edit the `merb.rb` file in the config directory, ensuring you at least create a new random API key.

Create first admin user
-----------------------

Login to the console with `merb -i`:

    u = User.new
    u.login = 'admin'
    u.email = 'email@mydomain'
    u.set_password('SECRETPASS')
    u.save

Create an encoding profile
--------------------------

    Profile.create!(:title => "Flash video HI",  :container => "flv", :video_bitrate => 400, :audio_bitrate => 48, :width => 480, :height => 360, :fps => 24, :position => 1, :player => "flash")